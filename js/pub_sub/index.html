<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>订阅发布者模式</title>
  <style>
  html,body {
    height: 100%;
  }
  
  </style>
</head>
<body>
  <script>
    //listener 收听者es callback    发布者document.body
    // 注册事件 事件的回调函数的执行
  // document.body.addEventListener('click',function() {
  //   alert("111");
  // },false);
  // document.body.addEventListener('click',function() {
  //   alert("222");
  // },false);
  // document.body.addEventListener('click',function() {
  //   alert("333");
  // },false);

  let yq = {
    name:'yq',
    yz:99};//发布者
  yq.peopleList = []; //存储订阅者的地方
  yq.listen = function (fn) {
    this.peopleList.push(fn);
  }
  yq.trigger = function() {
    for(var i = 0,fn;fn = this.peopleList[i++];) {
      
      fn.call(this,'今晚没空');
    }
  }
  
  yq.listen(function (msg) {
    console.log(`想听${this.name} ${msg}sing`);
  });
  yq.listen(function (msg) {
    console.log(`想听${this.name} ${msg}dance`);
  });
  yq.listen(function (msg) {
    console.log(`想听${this.name} ${msg}...`);
  });
  // 先形成他们之间的关系
  console.log(yq.peopleList.length);

  setTimeout(() => {
    yq.trigger();
  },3000)
  </script>
</body>
</html>